<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="discuss"> 
      <resultMap type="dsvo" id="discussListRM">
		<result property="discussionNo" column="discussion_no" />			
		<result property="discussionDate" column="discussion_date" /> 
		<result property="discussionDate" column="discussion_date" /> 
		<result property="discussionSubject" column="discussion_subject" /> 
	</resultMap>
	<select id="getAllDiscussList" resultMap="discussListRM">
		<!-- select d.discussion_no,d.id,d.title,d.content,d.discussion_date,d.hit,d.discussion_subject,dc.discussion_comment_no,dc.id,dc.discussion_no,dc.content,dc.discussion_comment_date,dc.ref,dc.restep,dc.relevel from DISCUSSION d, DISCUSSION_COMMENT dc where d.id=dc.id -->
		select discussion_no,id,title,content,discussion_date,hit,discussion_subject
 	from(	select discussion_no,id,title,content,discussion_date,hit,discussion_subject,ceil(rownum/5) as page 
 			from(select discussion_no,id,title,content,to_char(discussion_date,'YYYY.MM.DD') as discussion_date,hit,discussion_subject 
 				   from discussion 
 				   order by discussion_no desc
				   )
		  )
	where page=#{value}
	</select>
	<select id="totalContent" resultType="int">
		select count(*)  from DISCUSSION d, DISCUSSION_COMMENT dc where d.id=dc.id
	</select>
	<select id="findDiscussContent" resultMap="discussListRM">
		<!-- select d.discussion_no,d.id,d.title,d.content,d.discussion_date,d.hit,d.discussion_subject,dc.discussion_comment_no,dc.id,dc.discussion_no,dc.content,dc.discussion_comment_date,dc.ref,dc.restep,dc.relevel from DISCUSSION d, DISCUSSION_COMMENT dc where d.id=dc.id  and d.discussion_no=#{value} -->
		select discussion_no,id,title,content,discussion_date,hit,discussion_subject from discussion where discussion_no=#{value}
	</select> 
      <resultMap type="cmvo" id="discussCommentRM">
		<result property="no" column="discussion_comment_no" />			
		<result property="index" column="discussion_no" /> 
		<result property="date" column="discussion_comment_date" /> 
	</resultMap>
	<select id="findDiscussComment" resultMap="discussCommentRM">
		select discussion_comment_no,id,discussion_no,content,discussion_comment_date,ref,restep,relevel from discussion_comment where discussion_no=#{value}
	</select>
	<delete id="deleteDiscussComment" parameterType="cmvo">
		delete from discussion_comment where discussion_comment_no=#{value}
	</delete>
	<insert id="registerDiscussComment" parameterMap="discussCommentRM">
		
	</insert>
 </mapper> 		
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
















